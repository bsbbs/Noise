grpbid$item <- as.factor(grpbid$item)
# check again after change
str(grpbid)
bid1 <- grpbid[grpbid$bid_times == 1,]
bid2 <- grpbid[grpbid$bid_times == 2,]
bid3 <- grpbid[grpbid$bid_times == 3,]
long <- merge(bid1, bid2, by = c('subID','item'))
long <- merge(long, bid3, by = c('subID','item'))
par(mfrow = c(2,2))
plot(long$bid.x, long$bid.y, pch = 20, cex = .3, xlab = 'bid 1', ylab = 'bid 2')
plot(long$bid, long$bid.y, pch = 20, cex = .3, xlab = 'bid 3', ylab = 'bid 2')
plot(long$bid.x, long$bid, pch = 20, cex = .3, xlab = 'bid 1', ylab = 'bid 3')
dev.copy(pdf,file.path(out_dir,'Bid123.pdf'),height=8, width=8)
dev.off()
Indvdir <- file.path(out_dir, 'IndvBid')
if (!file.exists(Indvdir))
{dir.create(Indvdir)}
# individual
for (s in 1:length(subID))
{
plot(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 1],sdbid$bid[sdbid$subID == subID[s] & meanbid$touched == 1], pch = 20, col = 'red', xlab = 'Bid mean', ylab = 'Bid variance', main = subID[s])
points(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 0],sdbid$bid[sdbid$subID == subID[s] & meanbid$touched == 0], pch = 20, col = 'blue')
legend('topleft',c('Touched (Precise)','Untouched (Vauge)'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
# save the figure
dev.copy(pdf,file.path(out_dir,'IndvBid',sprintf("BidVariance%s.pdf",subID[s])),height=4, width=4)
dev.off()
}
grpdcsn$Group <- as.factor(grpdcsn$Group)
grpdcsn$subID <- as.factor(grpdcsn$subID)
grpdcsn$Vagueness <- as.factor(grpdcsn$Vagueness)
grpdcsn$TimePressure <- as.factor(grpdcsn$TimePressure)
grpdcsn$VD <- grpdcsn$V2 - grpdcsn$V1 # in the design, V2 is always larger than V1
grpdcsn$choice <- grpdcsn$chosenItem - 1 # choose #1 coded as 0 (incorrect); choose #2 coded as 1 (correct); choose #3 coded as 2, discard; NaN choice not made
grpdcsn$normv3 <- grpdcsn$V3/(grpdcsn$V1 + grpdcsn$V2)*2
grpdcsn$V1scld <- grpdcsn$V1
grpdcsn$V2scld <- grpdcsn$V2
grpdcsn$V3scld <- grpdcsn$V3
subjlist <- unique(grpdcsn$subID)
for (s in subjlist)
{
mask <- grpdcsn$subID == s
maxval <- max(c(grpdcsn$V1[mask],grpdcsn$V2[mask],grpdcsn$V3[mask]))
minval <- min(c(grpdcsn$V1[mask],grpdcsn$V2[mask]))
grpdcsn$V1scld[mask] <- grpdcsn$V1[mask]/minval
grpdcsn$V2scld[mask] <- grpdcsn$V2[mask]/minval
grpdcsn$V3scld[mask] <- grpdcsn$V3[mask]/minval
}
grpdcsn$VDscld <- grpdcsn$V2scld - grpdcsn$V1scld
# discard the trials where V1 == V2
grpdcsn <- grpdcsn[grpdcsn$V1 != grpdcsn$V2,]
str(grpdcsn)
out_dir <- '/Users/bs3667/Noise/modelfit/Results/FastBADS_Mtlb/plot'
fastbads <- read.table('/Users/bs3667/Noise/modelfit/Results/FastBADS_Mtlb/Rslts_FastBADS_Best.txt', header = TRUE, sep = '\t')
fastbads <- fastbads[fastbads$subID < 48,]
fastbads$subID <- as.factor(fastbads$subID)
fastbads$name <- factor(fastbads$name, levels = c('McFadden','Model2','DN','dDNa','dDNb','dDNc','dDNd'))
fastbads$modeli <- as.factor(fastbads$modeli)
str(fastbads)
summary(test <- aov(nll ~ name + Error(subID), data = fastbads))
names <- unique(fastbads$name)
subjlist <- unique(fastbads$subID)
par(mfrow=c(3,2))
for (mdli in 1)
{
for (mdlj in 2:7)
{
bars <- fastbads$nll[fastbads$modeli == mdlj] - fastbads$nll[fastbads$modeli == mdli]
barplot(bars, ylab = 'nLL', xlab = 'Subjects', names = subjlist, main = sprintf('%s - %s', names[mdlj], names[mdli]))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
# plot(fastbads$nll[fastbads$modeli==mdli], fastbads$nll[fastbads$modeli==mdlj], type = 'p', pch = 20, xlab = names[mdli], ylab = names[mdlj], xlim = range(c(fastbads$nll[fastbads$modeli==mdli], fastbads$nll[fastbads$modeli==mdlj])), ylim = range(c(fastbads$nll[fastbads$modeli==mdli], fastbads$nll[fastbads$modeli==mdlj])))
# abline(a = 0, b = 1, lty = 1)
}
}
par(mfrow=c(3,2))
for (mdli in 2)
{
for (mdlj in 3:7)
{
bars <- fastbads$nll[fastbads$modeli == mdlj] - fastbads$nll[fastbads$modeli == mdli]
barplot(bars, ylab = 'nLL', xlab = 'Subjects', names = subjlist, main = sprintf('%s - %s', names[mdlj], names[mdli]))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
}
}
par(mfrow=c(2,2))
for (mdli in 3)
{
for (mdlj in 4:7)
{
bars <- fastbads$nll[fastbads$modeli == mdlj] - fastbads$nll[fastbads$modeli == mdli]
barplot(bars, ylab = 'nLL', xlab = 'Subjects', names = subjlist, main = sprintf('%s - %s', names[mdlj], names[mdli]))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
}
}
par(mfrow=c(1,2))
for (mdli in 1:2)
{
bars <- fastbads$eta[fastbads$modeli == mdli]
plot(density(bars), xlab = 'eta', main = names[mdli], bty = 'n')
legend('topleft',sprintf('mean eta = %1.1f', mean(bars)), bty = 'n')
}
dev.copy(pdf,file.path(out_dir,sprintf("eta.pdf")),height=3, width=6)
dev.off()
par(mfrow=c(2,3))
for (mdli in 3:7)
{
bars <- fastbads$Mp[fastbads$modeli == mdli]
plot(density(bars), xlab = 'Mp', main = names[mdli], bty = 'n')
legend('topleft',sprintf('mean Mp = %1.1f', mean(bars)), bty = 'n')
}
dev.copy(pdf,file.path(out_dir,sprintf("Mp.pdf")),height=6, width=6)
dev.off()
par(mfrow=c(2,3))
for (mdli in 3:7)
{
bars <- fastbads$wp[fastbads$modeli == mdli]
plot(density(bars), xlab = 'wp', main = names[mdli], bty = 'n')
legend('topleft',sprintf('mean wp = %.3f', mean(bars)), bty = 'n')
}
dev.copy(pdf,file.path(out_dir,sprintf("wp.pdf")),height=6, width=6)
dev.off()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/Users/bs3667/Dropbox (NYU Langone Health)/CESS-Bo/AnalysisII')
Analysis <- '/Users/bs3667/Noise/modelfit/Results/FastBADS_nonNgtv'
out_dir <- file.path(Analysis,'plot')
fastbads <- read.table(file.path(Analysis,'Rslts_FastBADS_Best.txt'), header = TRUE, sep = '\t')
fastbads <- fastbads[fastbads$subID < 48,]
fastbads$subID <- as.factor(fastbads$subID)
fastbads$name <- factor(fastbads$name, levels = c('McFadden','Model2','DN','dDNa','dDNb','dDNc','dDNd'))
fastbads$modeli <- as.factor(fastbads$modeli)
str(fastbads)
summary(test <- aov(nll ~ name + Error(subID), data = fastbads))
names <- unique(fastbads$name)
subjlist <- unique(fastbads$subID)
Analysis <- '/Users/bs3667/Noise/modelfit/Results/FastBADS_nonNgtv'
out_dir <- file.path(Analysis,'plot')
fastbads <- read.table(file.path(Analysis,'Rslts_FastBADS_Best.txt'), header = TRUE, sep = '\t')
fastbads <- fastbads[fastbads$subID < 48,]
fastbads$subID <- as.factor(fastbads$subID)
fastbads$name <- factor(fastbads$name, levels = c('McFadden','Model2','DN','dDNa','dDNb','dDNc','dDNd'))
fastbads$modeli <- as.factor(fastbads$modeli)
str(fastbads)
summary(test <- aov(nll ~ name + Error(subID), data = fastbads))
names <- unique(fastbads$name)
subjlist <- unique(fastbads$subID)
# Model comparison
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
dev.copy(pdf,file.path(out_dir,sprintf("Model2_vs_McFadden.pdf")),height=3, width=3)
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 20)
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Model2_vs_McFadden.pdf")),height=3, width=3)
dev.off()
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 20, ylim = c(-20,20))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 20, xlim = c(-20,20))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 50, xlim = c(-12,12))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 50, xlim = c(-12,12))
legend('bottomleft',sprintf('delta nLL = %1.3f', sum(bars)), bty = 'n')
bars
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 50, xlim = c(-12,12))
#legend('bottomleft',sprintf('\Delta nLL = %1.3f', sum(bars)), bty = 'n')
legend('bottomleft', sprintf('\\Delta nLL = %1.3f', sum(bars)), bty = 'n')
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 50, xlim = c(-12,12))
legend('bottomleft', legend = expression(Delta~nLL == 1.234), bty = 'n')
sum(bars)
bars <- fastbads$nll[fastbads$modeli == 2] - fastbads$nll[fastbads$modeli == 1]
hist(bars, xlab = 'nLL', main = sprintf('%s - %s', names[2], names[1]), 50, xlim = c(-12,12))
legend('left', legend = expression(With outlier: Delta~nLL == -93.6), bty = 'n')
range(bars)
sum(bars[bars>-100])
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/Users/bs3667/Dropbox (NYU Langone Health)/CESS-Bo/AnalysisII')
meanbid <- aggregate(bid ~ item + touched +  subID, FUN = mean, data = grpbid)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/Users/bs3667/Dropbox (NYU Langone Health)/CESS-Bo/AnalysisII')
# data_dir <- '/Users/bs3667/Documents/Projects/Noise/CESS-Bo/TaskProgram/log/txtDat'
data_dir <- '/Users/bs3667/Dropbox (NYU Langone Health)/CESS-Bo/TaskProgram/log/txtDat'
out_dir <- '/Users/bs3667/Dropbox (NYU Langone Health)/CESS-Bo/AnalysisII'
filelistbid <- list.files(path = data_dir, pattern = 'BidTask_')
filelistchoice <- list.files(path = data_dir, pattern = 'MainTask_')
grpbid <- c()
grpdcsn <- c()
for (s in 1:length(filelistbid))
{
indvbid <- read.table(file.path(data_dir,filelistbid[s]), head = TRUE, sep = '\t')
grpbid <- rbind(grpbid,indvbid)
indvdcsn <- read.table(file.path(data_dir,filelistchoice[s]), head = TRUE, sep = '\t')
grpdcsn <- rbind(grpdcsn,indvdcsn)
}
subjlist <- unique(grpbid$subID)
Nsubj <- length(subjlist)
# normalize within subjects
bidmax <- aggregate(bid ~ subID, data = grpbid, FUN = max)
grpbid$normbid <- 0
for (subi in 1:Nsubj)
{
indvmask <- grpbid$subID == subjlist[subi]
grpbid$normbid[indvmask] <- grpbid$bid[indvmask]/bidmax$bid[bidmax$subID == subjlist[subi]]
}
par(mfrow = c(2,1))
barx <- boxplot(normbid ~ subID, data = grpbid, las = 2)
normbidvar <- aggregate(normbid ~ subID, data = grpbid, FUN = sd)
barplot(normbid ~ subID, las = 2, data = normbidvar, col = 8)
dev.copy(pdf,file.path(out_dir,sprintf("BidQuality.pdf")), height=8, width=12)
dev.off()
blacklist <- c() # pick out the subjects whos bidding on the precise targets (the highest 6 items) are all zero
for (subi in 1:Nsubj)
{
indvdat <- grpbid[grpbid$subID == subjlist[subi],]
itemmean <- aggregate(bid ~ item + patch + Group, data = indvdat, FUN = mean)
itemmean$touch <- itemmean$patch == itemmean$Group
bidord <- order(itemmean$bid)
itemmean$ord <- bidord
itemmean <- itemmean[bidord,]
items <- 1:36
plot(items, itemmean$bid, type = 'l', main = subjlist[subi])
points(items[itemmean$bid > 0], itemmean$bid[itemmean$bid > 0], pch = 20)
preciseitems <- itemmean$item[itemmean$touch == TRUE]
loc <- rank(itemmean$ord[itemmean$touch == TRUE]) > 12
mask <- itemmean$item %in% preciseitems[loc]
points(items[mask],itemmean$bid[mask], pch = 1, col = 2)
if (all(itemmean$bid[mask] == 0))
{
blacklist <- c(blacklist, subjlist[subi])
}
}
blacklist <- c(blacklist, '22102708', '22071913', '22110306')
# 22071913 bid all V3 as zero, 22102708 bid all v3 and five targets as zero, 22110306 bid one of the targets as zero
grpbid <- grpbid[!grpbid$subID %in% blacklist,]
str(grpbid)
Ngroup <- aggregate(Group ~ subID, data = grpbid, FUN = unique)
subID <- unique(grpbid$subID)
grpdcsn <- grpdcsn[!grpdcsn$subID %in% blacklist,]
str(grpdcsn)
grpbid$touched <- factor(as.numeric(grpbid$Group == grpbid$patch), level = c(1,0))
grpbid$Group <- as.factor(grpbid$Group)
grpbid$subID <- as.factor(grpbid$subID)
grpbid$trial <- as.factor(grpbid$trial)
grpbid$item <- as.factor(grpbid$item)
# check again after change
str(grpbid)
bid1 <- grpbid[grpbid$bid_times == 1,]
bid2 <- grpbid[grpbid$bid_times == 2,]
bid3 <- grpbid[grpbid$bid_times == 3,]
long <- merge(bid1, bid2, by = c('subID','item'))
long <- merge(long, bid3, by = c('subID','item'))
par(mfrow = c(2,2))
plot(long$bid.x, long$bid.y, pch = 20, cex = .3, xlab = 'bid 1', ylab = 'bid 2')
plot(long$bid, long$bid.y, pch = 20, cex = .3, xlab = 'bid 3', ylab = 'bid 2')
plot(long$bid.x, long$bid, pch = 20, cex = .3, xlab = 'bid 1', ylab = 'bid 3')
dev.copy(pdf,file.path(out_dir,'Bid123.pdf'),height=8, width=8)
dev.off()
Indvdir <- file.path(out_dir, 'IndvBid')
if (!file.exists(Indvdir))
{dir.create(Indvdir)}
# individual
for (s in 1:length(subID))
{
plot(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 1],sdbid$bid[sdbid$subID == subID[s] & meanbid$touched == 1], pch = 20, col = 'red', xlab = 'Bid mean', ylab = 'Bid variance', main = subID[s])
points(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 0],sdbid$bid[sdbid$subID == subID[s] & meanbid$touched == 0], pch = 20, col = 'blue')
legend('topleft',c('Touched (Precise)','Untouched (Vauge)'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
# save the figure
dev.copy(pdf,file.path(out_dir,'IndvBid',sprintf("BidVariance%s.pdf",subID[s])),height=4, width=4)
dev.off()
}
meanbid <- aggregate(bid ~ item + touched +  subID, FUN = mean, data = grpbid)
sdbid <- aggregate(bid ~ item + touched + subID, FUN = sd, data = grpbid)
varbid <- aggregate(bid ~ item + touched + subID, FUN = var, data = grpbid)
Indvdir <- file.path(out_dir, 'IndvBid')
if (!file.exists(Indvdir))
{dir.create(Indvdir)}
# individual
for (s in 1:length(subID))
{
plot(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 1],sdbid$bid[sdbid$subID == subID[s] & meanbid$touched == 1], pch = 20, col = 'red', xlab = 'Bid mean', ylab = 'Bid variance', main = subID[s])
points(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 0],sdbid$bid[sdbid$subID == subID[s] & meanbid$touched == 0], pch = 20, col = 'blue')
legend('topleft',c('Touched (Precise)','Untouched (Vauge)'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
# save the figure
dev.copy(pdf,file.path(out_dir,'IndvBid',sprintf("BidVariance%s.pdf",subID[s])),height=4, width=4)
dev.off()
}
Indvdir <- file.path(out_dir, 'IndvBid')
if (!file.exists(Indvdir))
{dir.create(Indvdir)}
# individual
for (s in 1:length(subID))
{
plot(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 1],varbid$bid[varbid$subID == subID[s] & meanbid$touched == 1], pch = 20, col = 'red', xlab = 'Bid mean', ylab = 'Bid variance', main = subID[s])
points(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 0]varbid$bid[varbid$subID == subID[s] & meanbid$touched == 0], pch = 20, col = 'blue')
Indvdir <- file.path(out_dir, 'IndvBid')
if (!file.exists(Indvdir))
{dir.create(Indvdir)}
# individual
for (s in 1:length(subID))
{
plot(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 1],varbid$bid[varbid$subID == subID[s] & meanbid$touched == 1], pch = 20, col = 'red', xlab = 'Bid mean', ylab = 'Bid variance', main = subID[s])
points(meanbid$bid[meanbid$subID == subID[s] & meanbid$touched == 0],varbid$bid[varbid$subID == subID[s] & meanbid$touched == 0], pch = 20, col = 'blue')
legend('topleft',c('Touched (Precise)','Untouched (Vauge)'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
# save the figure
dev.copy(pdf,file.path(out_dir,'IndvBid',sprintf("BidVariance%s.pdf",subID[s])),height=4, width=4)
dev.off()
}
test <- aov(bid ~ touched + Error(subID), data = varbid)
#summary(test)
require(lmerTest)
Htest <- lmer(bid ~ touched + (1|subID), data = varbid)
#summary(Htest)
mrgdat <- merge(meanbid, sdbid, by = c('subID','item','touched'))
mrgdat$bidmean <- mrgdat$bid.x
mrgdat$bidvar <- mrgdat$bid.y
Rgtest <- lmer(bidvar ~ bidmean * touched + (1|subID), data = mrgdat)
summary(Rgtest)
bid
test <- aov(bid ~ touched + Error(subID), data = varbid)
summary(test)
require(lmerTest)
Htest <- lmer(bid ~ touched + (1|subID), data = varbid)
summary(Htest)
# test <- aov(bid ~ touched + Error(subID), data = varbid)
# summary(test)
# require(lmerTest)
# Htest <- lmer(bid ~ touched + (1|subID), data = varbid)
# summary(Htest)
mrgdat <- merge(meanbid, varbid, by = c('subID','item','touched'))
mrgdat$bidmean <- mrgdat$bid.x
mrgdat$bidvar <- mrgdat$bid.y
Rgtest <- lmer(bidvar ~ bidmean * touched + (1|subID), data = mrgdat)
summary(Rgtest)
redtrnsp <- rgb(255,0,0,50, maxColorValue = 255)
bluetrnsp <- rgb(0,0,255,50, maxColorValue = 255)
# group overlay
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 1,]
if (s == 1){plot(patchdat$bid.x, patchdat$bid.y, pch = 20, col = 'red', xlab = ' ', ylab = ' ', xlim = c(0,90), ylim = c(0,50), frame.plot = TRUE, axes = FALSE,  xaxt = "n", yaxt = "n")}else{points(patchdat$bid.x,patchdat$bid.y, pch = 20, col = redtrnsp)}
abline(lm(bid.y ~ bid.x, data = patchdat), col = redtrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 1,]
abline(lm(bid.y ~ bid.x, data = patchdat), col = 'red', lwd = 3)
axis(1, at = c(seq(0,90,20)),  tck = -0.03, padj = -1.4, cex.axis = .8)
axis(2, tck = -0.03, at = c(seq(0,50,10)), padj = 1.4, cex.axis = .8)
title(ylab = 'Bid variance', mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
title(xlab = "Bid mean", mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
legend('topleft',c('Precise',' '), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red',NA), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("SfN23NANO_BidVariance_A.pdf")),height=4, width=3.7)
dev.off()
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 0,]
points(patchdat$bid.x, patchdat$bid.y, pch = 20, col = bluetrnsp)
abline(lm(bid.y ~ bid.x, data = patchdat), col = bluetrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 0,]
abline(lm(bid.y ~ bid.x, data = patchdat), col = 'blue', lwd = 3)
legend('topleft',c('Precise','Vague'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("SfN23NANO_BidVariance_B.pdf")),height=4, width=3.7)
dev.off()
range(mrgdat$bidvar)
range(mrgdat$bidmean)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/Users/bs3667/Dropbox (NYU Langone Health)/Bo Shen Working files/NoiseProject/AnalysisII')
# data_dir <- '/Users/bs3667/Documents/Projects/Noise/CESS-Bo/TaskProgram/log/txtDat'
data_dir <- '/Users/bs3667/Dropbox (NYU Langone Health)/CESS-Bo/TaskProgram/log/txtDat'
out_dir <- '/Users/bs3667/Dropbox (NYU Langone Health)/Bo Shen Working files/NoiseProject/AnalysisII'
redtrnsp <- rgb(255,0,0,50, maxColorValue = 255)
bluetrnsp <- rgb(0,0,255,50, maxColorValue = 255)
# group overlay
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 1,]
if (s == 1){plot(patchdat$bidmean, patchdat$bidvar, pch = 20, col = 'red', xlab = ' ', ylab = ' ', xlim = c(0,90), ylim = c(0,50), frame.plot = TRUE, axes = FALSE,  xaxt = "n", yaxt = "n")}else{points(patchdat$bidmean,patchdat$bid.y, pch = 20, col = redtrnsp)}
abline(lm(bid.y ~ bidmean, data = patchdat), col = redtrnsp)
}
redtrnsp <- rgb(255,0,0,50, maxColorValue = 255)
bluetrnsp <- rgb(0,0,255,50, maxColorValue = 255)
# group overlay
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 1,]
if (s == 1){plot(patchdat$bidmean, patchdat$bidvar, pch = 20, col = 'red', xlab = ' ', ylab = ' ', xlim = c(0,90), ylim = c(0,2500), frame.plot = TRUE, axes = FALSE,  xaxt = "n", yaxt = "n")}else{points(patchdat$bidmean,patchdat$bid.y, pch = 20, col = redtrnsp)}
abline(lm(bid.y ~ bidmean, data = patchdat), col = redtrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 1,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'red', lwd = 3)
axis(1, at = c(seq(0,90,20)),  tck = -0.03, padj = -1.4, cex.axis = .8)
axis(2, tck = -0.03, at = c(seq(0,50,10)), padj = 1.4, cex.axis = .8)
title(ylab = 'Bid variance', mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
title(xlab = "Bid mean", mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
legend('topleft',c('Precise',' '), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red',NA), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_A.pdf")),height=4, width=3.7)
dev.off()
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 0,]
points(patchdat$bidmean, patchdat$bidvar, pch = 20, col = bluetrnsp)
abline(lm(bidvar ~ bidmean, data = patchdat), col = bluetrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 0,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'blue', lwd = 3)
legend('topleft',c('Precise','Vague'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_B.pdf")),height=4, width=3.7)
dev.off()
redtrnsp <- rgb(255,0,0,50, maxColorValue = 255)
bluetrnsp <- rgb(0,0,255,50, maxColorValue = 255)
# group overlay
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 1,]
if (s == 1){plot(patchdat$bidmean, patchdat$bidvar, pch = 20, col = 'red', xlab = ' ', ylab = ' ', xlim = c(0,90), ylim = c(0,1000), frame.plot = TRUE, axes = FALSE,  xaxt = "n", yaxt = "n")}else{points(patchdat$bidmean,patchdat$bid.y, pch = 20, col = redtrnsp)}
abline(lm(bid.y ~ bidmean, data = patchdat), col = redtrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 1,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'red', lwd = 3)
axis(1, at = c(seq(0,90,20)),  tck = -0.03, padj = -1.4, cex.axis = .8)
axis(2, tck = -0.03, at = c(seq(0,50,10)), padj = 1.4, cex.axis = .8)
title(ylab = 'Bid variance', mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
title(xlab = "Bid mean", mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
legend('topleft',c('Precise',' '), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red',NA), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_A.pdf")),height=4, width=3.7)
dev.off()
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 0,]
points(patchdat$bidmean, patchdat$bidvar, pch = 20, col = bluetrnsp)
abline(lm(bidvar ~ bidmean, data = patchdat), col = bluetrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 0,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'blue', lwd = 3)
legend('topleft',c('Precise','Vague'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_B.pdf")),height=4, width=3.7)
dev.off()
redtrnsp <- rgb(255,0,0,50, maxColorValue = 255)
bluetrnsp <- rgb(0,0,255,50, maxColorValue = 255)
# group overlay
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 1,]
if (s == 1){plot(patchdat$bidmean, patchdat$bidvar, pch = 20, col = 'red', xlab = ' ', ylab = ' ', xlim = c(0,90), ylim = c(0,500), frame.plot = TRUE, axes = FALSE,  xaxt = "n", yaxt = "n")}else{points(patchdat$bidmean,patchdat$bid.y, pch = 20, col = redtrnsp)}
abline(lm(bid.y ~ bidmean, data = patchdat), col = redtrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 1,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'red', lwd = 3)
axis(1, at = c(seq(0,90,20)),  tck = -0.03, padj = -1.4, cex.axis = .8)
axis(2, tck = -0.03, at = c(seq(0,50,10)), padj = 1.4, cex.axis = .8)
title(ylab = 'Bid variance', mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
title(xlab = "Bid mean", mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
legend('topleft',c('Precise',' '), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red',NA), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_A.pdf")),height=4, width=3.7)
dev.off()
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 0,]
points(patchdat$bidmean, patchdat$bidvar, pch = 20, col = bluetrnsp)
abline(lm(bidvar ~ bidmean, data = patchdat), col = bluetrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 0,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'blue', lwd = 3)
legend('topleft',c('Precise','Vague'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_B.pdf")),height=4, width=3.7)
dev.off()
redtrnsp <- rgb(255,0,0,50, maxColorValue = 255)
bluetrnsp <- rgb(0,0,255,50, maxColorValue = 255)
# group overlay
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 1,]
if (s == 1){plot(patchdat$bidmean, patchdat$bidvar, pch = 20, col = 'red', xlab = ' ', ylab = ' ', xlim = c(0,90), ylim = c(0,500), frame.plot = TRUE, axes = FALSE,  xaxt = "n", yaxt = "n")}else{points(patchdat$bidmean,patchdat$bid.y, pch = 20, col = redtrnsp)}
abline(lm(bid.y ~ bidmean, data = patchdat), col = redtrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 1,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'red', lwd = 3)
axis(1, at = c(seq(0,90,20)),  tck = -0.03, padj = -1.4, cex.axis = .8)
axis(2, tck = -0.03, at = c(seq(0,500,100)), padj = 1.4, cex.axis = .8)
title(ylab = 'Bid variance', mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
title(xlab = "Bid mean", mgp = c(1.2,0,0), font.lab = 1, cex.lab = 1)
legend('topleft',c('Precise',' '), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red',NA), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_A.pdf")),height=4, width=3.7)
dev.off()
for (s in 1:length(subID))
{
indvdat <- mrgdat[mrgdat$subID == subID[s],]
patchdat <- indvdat[indvdat$touched == 0,]
points(patchdat$bidmean, patchdat$bidvar, pch = 20, col = bluetrnsp)
abline(lm(bidvar ~ bidmean, data = patchdat), col = bluetrnsp)
}
patchdat <- mrgdat[mrgdat$touched == 0,]
abline(lm(bidvar ~ bidmean, data = patchdat), col = 'blue', lwd = 3)
legend('topleft',c('Precise','Vague'), text.col = c('red','blue'), pch = 20, cex = .8, col = c('red','blue'), bty = 'n')
dev.copy(pdf,file.path(out_dir,sprintf("Paper_BidVariance_B.pdf")),height=4, width=3.7)
dev.off()
level(mrgdat$touched)
levels(mrgdat$touched)
str(mrgdat$touched)
factor(mrgdat$touched)
